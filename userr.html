<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Neon E-Hailing â€” User</title>

<!-- Neon + Modern UI, no external deps -->
<style>
  /* CSS Variables (light theme defaults) */
  :root{
    --bg: #eef2f5;
    --panel: rgba(255,255,255,0.9);
    --muted: #6b7280;
    --text: #0f172a;
    --accent-1: #06b6d4; /* cyan */
    --accent-2: #8b5cf6; /* purple */
    --glass: rgba(255,255,255,0.06);
    --shadow: 0 6px 20px rgba(2,6,23,0.12);
  }

  /* Dark neon theme variables */
  .dark {
    --bg: #02030a;
    --panel: rgba(2,6,23,0.55);
    --muted: #9aa6b2;
    --text: #e6f7fb;
    --accent-1: #00f0ff;
    --accent-2: #a14bff;
    --glass: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    --shadow: 0 10px 30px rgba(99,26,255,0.08);
  }

  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(11,68,108,0.06), transparent),
                radial-gradient(900px 400px at 90% 90%, rgba(127,21,255,0.04), transparent),
                var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    gap: 24px;
    padding: 24px;
    transition: background 0.4s ease, color 0.3s ease;
  }

  /* Layout */
  .sidebar {
    width: 260px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
    border-radius: 14px;
    padding: 22px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(8px);
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .brand {
    display:flex; align-items:center; gap:12px;
  }
  .logo {
    width:48px; height:48px; border-radius:10px;
    background: linear-gradient(135deg,var(--accent-1),var(--accent-2));
    display:flex; align-items:center; justify-content:center;
    color: #021; font-weight:700; box-shadow: 0 6px 18px rgba(99,26,255,0.18);
  }
  .brand h2 { margin:0; font-size:18px; letter-spacing:0.2px; }

  nav a {
    display:flex; gap:12px; align-items:center;
    padding:10px 12px; border-radius:10px;
    color:var(--text); text-decoration:none; font-weight:600;
    transition: transform .18s ease, background .18s ease, color .18s ease;
  }
  nav a:hover {
    transform: translateX(6px);
    background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  }

  .toggle-row { margin-top:auto; display:flex; gap:10px; align-items:center; justify-content:space-between; }

  /* Main content */
  .main {
    flex:1;
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  .topbar {
    display:flex; align-items:center; justify-content:space-between;
    gap:18px;
  }

  .header {
    font-size:22px; font-weight:700;
    background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
    -webkit-background-clip: text; background-clip:text; color:transparent;
  }

  /* Neon card */
  .card {
    background: var(--panel);
    border-radius:14px;
    padding:18px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(8px);
    transition: transform .18s ease, box-shadow .18s ease;
  }

  .map-card {
    display:flex; gap:18px; align-items:stretch;
  }

  .map {
    flex:1; border-radius:12px; overflow:hidden; min-height:320px; position:relative;
    box-shadow: 0 6px 30px rgba(7,16,46,0.12) inset;
    border: 1px solid rgba(255,255,255,0.04);
  }
  .map iframe { width:100%; height:100%; border:0; display:block; }

  /* Booking panel */
  .panel {
    width:420px; min-width:320px; display:flex; flex-direction:column; gap:12px;
  }

  h3 { margin:0 0 8px 0; font-size:16px; letter-spacing:0.2px; }
  label { display:block; font-size:13px; margin-bottom:6px; color:var(--muted); }

  .input {
    width:100%; padding:12px 14px; border-radius:10px; border:1px solid rgba(0,0,0,0.06);
    background: rgba(255,255,255,0.03);
    color:var(--text); font-size:14px; outline:none;
    transition: box-shadow .15s ease, border-color .15s ease;
  }
  .input:focus { box-shadow: 0 6px 20px rgba(6,182,212,0.08); border-color:var(--accent-1); }

  .booking-row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .btn {
    padding:10px 14px; border-radius:10px; cursor:pointer; border:none; font-weight:600;
    background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
    color: #021; box-shadow: 0 10px 30px rgba(99,26,255,0.12);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .btn:hover { transform: translateY(-4px); box-shadow: 0 18px 40px rgba(99,26,255,0.16); }

  .small-btn { padding:8px 12px; font-size:13px; background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03); }

  /* Vehicle selection */
  .vehicle-list { display:flex; gap:10px; }
  .vehicle {
    flex:1; padding:10px; border-radius:10px; cursor:pointer; display:flex; gap:10px; align-items:center;
    border:1px solid rgba(255,255,255,0.03); transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
  }
  .vehicle svg { width:44px; height:44px; flex-shrink:0; filter: drop-shadow(0 6px 18px rgba(6,182,212,0.08)); }
  .vehicle.selected {
    background: linear-gradient(135deg, rgba(0,240,255,0.08), rgba(161,75,255,0.06));
    box-shadow: 0 10px 40px rgba(99,26,255,0.08);
    transform: translateY(-6px);
    border-color: rgba(161,75,255,0.12);
  }

  .estimate {
    padding:12px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    display:flex; flex-direction:column; gap:6px;
  }
  .meter { font-size:20px; font-weight:700; }
  .muted { color:var(--muted); font-size:13px; }

  /* Recent trips */
  .trips { display:flex; flex-direction:column; gap:8px; }
  .trip { padding:10px; border-radius:8px; display:flex; justify-content:space-between; background: rgba(255,255,255,0.02); }

  /* Footer small text */
  .small { font-size:12px; color:var(--muted); }

  /* Toggle */
  .switch { width:50px; height:28px; background:linear-gradient(90deg,#111, #222); border-radius:14px; position:relative; cursor:pointer; }
  .switch .knob { position:absolute; width:22px; height:22px; border-radius:50%; top:3px; left:3px; background:white; transition:left .18s ease, box-shadow .18s ease; box-shadow:0 6px 18px rgba(6,182,212,0.12); }
  .dark-toggle-on .knob { left:25px; box-shadow: 0 10px 30px rgba(161,75,255,0.12); }

  /* Responsive */
  @media (max-width:980px){
    body { flex-direction:column; padding:16px; }
    .sidebar { width:100%; display:flex; flex-direction:row; align-items:center; gap:10px; padding:12px; border-radius:12px; }
    .panel { width:100%; min-width:unset; }
    .map-card { flex-direction:column; gap:12px; }
    .map { min-height:220px; }
  }

  /* subtle neon outlines on focus */
  .focus-glow:focus { box-shadow: 0 0 22px rgba(6,182,212,0.12); }

  /* tiny animations */
  .fade-in { animation: fadeIn .36s ease both; }
  @keyframes fadeIn { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }

</style>
</head>
<body class="dark"> <!-- default to dark for the neon look -->

<!-- SIDEBAR -->
<aside class="sidebar card fade-in">
  <div class="brand">
    <div class="logo">NH</div>
    <div>
      <h2>NeonHail</h2>
      <div class="small muted">Fast â€¢ Neon â€¢ Smooth</div>
    </div>
  </div>

  <nav>
    <a href="#">ðŸš— Book Ride</a>
    <a href="#">ðŸ•’ My Rides</a>
    <a href="#">ðŸ’³ Payments</a>
    <a href="#">ðŸ‘¤ Profile</a>
  </nav>

  <div class="toggle-row">
    <div class="small muted">Dark Mode</div>
    <div id="darkSwitch" class="switch dark-toggle-on" title="Toggle dark mode">
      <div class="knob"></div>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <div>
      <div class="header">Welcome back, <span style="color:var(--accent-1)">User</span> ðŸ‘‹</div>
      <div class="small muted">Where are we going today?</div>
    </div>
    <div style="display:flex;align-items:center;gap:12px;">
      <button class="small-btn" id="myTripsBtn">Recent Trips</button>
      <button class="btn" id="helpBtn">Help</button>
    </div>
  </div>

  <!-- MAP + BOOKING -->
  <section class="card map-card fade-in" aria-label="Map and booking">
    <div class="map">
      <iframe id="mapFrame" src="https://www.google.com/maps?q=UiTM%20Arau&output=embed" loading="lazy" title="map"></iframe>
      <!-- neon overlay for style -->
      <div style="position:absolute; right:10px; bottom:10px; padding:8px 10px; border-radius:8px; background: linear-gradient(90deg, rgba(0,0,0,0.45), rgba(255,255,255,0.02)); color:var(--muted); font-size:13px;">
        Map preview
      </div>
    </div>

    <aside class="panel">
      <div class="card">
        <h3>Book a Ride</h3>

        <div style="display:flex; gap:8px; margin-bottom:8px;">
          <button class="btn" onclick="selectBooking('now')">Book Now</button>
          <button class="small-btn" onclick="selectBooking('later')">Book Later</button>
        </div>

        <div id="schedulePanel" style="display:none; margin-bottom:8px;">
          <label>Date</label>
          <input id="rideDate" class="input focus-glow" type="date">
          <label>Time</label>
          <input id="rideTime" class="input focus-glow" type="time">
        </div>

        <label>Pickup</label>
        <input id="pickup" class="input focus-glow" placeholder="Enter pickup location (e.g., UiTM Arau)">

        <label>Destination</label>
        <input id="destination" class="input focus-glow" placeholder="Enter destination (e.g., Arau KTM Station)">

        <div style="margin-top:10px;">
          <label>Choose Vehicle</label>
          <div class="vehicle-list" id="vehicleList">
            <div class="vehicle selected" data-type="car" tabindex="0" onclick="chooseVehicle(this)">
              <!-- car svg -->
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="6" y="22" width="52" height="18" rx="3" fill="url(#g1)"/>
                <path d="M8 28h48" stroke="rgba(0,0,0,0.06)" stroke-width="1.2"/>
                <circle cx="18" cy="44" r="4" fill="#fff" opacity="0.85"/>
                <circle cx="46" cy="44" r="4" fill="#fff" opacity="0.85"/>
                <defs>
                  <linearGradient id="g1" x1="0" x2="1">
                    <stop offset="0" stop-color="#00f0ff"/>
                    <stop offset="1" stop-color="#a14bff"/>
                  </linearGradient>
                </defs>
              </svg>
              <div>
                <div style="font-weight:700">Car</div>
                <div class="muted" style="font-size:13px">Comfort â€¢ 4 seats</div>
              </div>
            </div>

            <div class="vehicle" data-type="motor" tabindex="0" onclick="chooseVehicle(this)">
              <!-- motor svg -->
              <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 36h22l8-10h12l8 10" fill="url(#g2)"/>
                <circle cx="20" cy="46" r="5" fill="#fff" opacity="0.95"/>
                <circle cx="48" cy="46" r="5" fill="#fff" opacity="0.95"/>
                <defs>
                  <linearGradient id="g2" x1="0" x2="1">
                    <stop offset="0" stop-color="#00f0ff"/>
                    <stop offset="1" stop-color="#a14bff"/>
                  </linearGradient>
                </defs>
              </svg>
              <div>
                <div style="font-weight:700">Motor</div>
                <div class="muted" style="font-size:13px">Fast â€¢ 1 passenger</div>
              </div>
            </div>
          </div>
        </div>

        <div style="display:flex; gap:10px; margin-top:12px;">
          <div class="estimate" style="flex:1;">
            <div class="muted">Estimated distance</div>
            <div class="meter" id="estDistance">â€” km</div>
            <div class="muted">Price</div>
            <div style="display:flex; align-items:center; justify-content:space-between;">
              <div>
                <div id="estPrice" style="font-weight:800; font-size:18px">â€” RM</div>
                <div class="small muted" id="priceBreak">â€”</div>
              </div>
              <div style="font-size:12px; color:var(--muted)">rates: Car RM1.50/km â€¢ Motor RM0.80/km</div>
            </div>
          </div>

          <div style="display:flex; flex-direction:column; gap:8px; align-items:flex-end; width:160px;">
            <button class="btn" id="requestBtn" onclick="bookRide()">Request Ride</button>
            <button class="small-btn" onclick="simulateDriver()">Simulate Driver</button>
          </div>
        </div>

        <div id="rideStatus" class="small muted" style="margin-top:10px">Enter pickup & destination for estimate.</div>
      </div>

      <div class="card">
        <h3>Recent Trips</h3>
        <div class="trips" id="tripList">
          <div class="trip muted">No recent trips yet.</div>
        </div>
      </div>

      <div class="card small muted">
        Tip: Estimates are generated locally (deterministic) â€” same input â†’ same estimate. Use real distances with map APIs for production.
      </div>
    </aside>
  </section>

</main>

<!-- JS (estimator + UI) -->
<script>
  /* Theme toggle logic (neon) */
  const body = document.body;
  const darkSwitch = document.getElementById('darkSwitch');
  darkSwitch.addEventListener('click', () => {
    const knob = darkSwitch.querySelector('.knob');
    darkSwitch.classList.toggle('dark-toggle-on');
    body.classList.toggle('dark');
    // small visual: move knob
    if (body.classList.contains('dark')) {
      knob.style.left = '25px';
      knob.style.boxShadow = '0 10px 30px rgba(161,75,255,0.12)';
    } else {
      knob.style.left = '3px';
      knob.style.boxShadow = '0 6px 18px rgba(6,182,212,0.12)';
    }
  });

  /* Booking type toggles */
  function selectBooking(type) {
    const schedule = document.getElementById('schedulePanel');
    schedule.style.display = (type === 'later') ? 'block' : 'none';
  }

  /* Vehicle selection */
  let selectedVehicle = 'car';
  function chooseVehicle(el){
    document.querySelectorAll('.vehicle').forEach(v => v.classList.remove('selected'));
    el.classList.add('selected');
    selectedVehicle = el.dataset.type;
    computeEstimate();
  }

  // inputs and map update
  const pickupInput = document.getElementById('pickup');
  const destInput = document.getElementById('destination');
  const mapFrame = document.getElementById('mapFrame');

  pickupInput.addEventListener('input', updateMapAndEstimate);
  destInput.addEventListener('input', updateMapAndEstimate);

  function updateMapAndEstimate(){
    const pickup = pickupInput.value || 'UiTM Arau';
    const dest = destInput.value || '';
    let query = pickup;
    if (dest) query += ' to ' + dest;
    mapFrame.src = `https://www.google.com/maps?q=${encodeURIComponent(query)}&output=embed`;
    computeEstimate();
  }

  /* Deterministic distance estimator (hash strings -> km)
     Produces consistent distances for same pickup+dest without external API.
     Range roughly 1.0 â€” 22.0 km
  */
  function deterministicDistance(a, b){
    if(!a || !b) return null;
    const s = (a.trim().toLowerCase() + '|' + b.trim().toLowerCase());
    // simple hash
    let h = 0;
    for (let i=0;i<s.length;i++){
      h = (h * 31 + s.charCodeAt(i)) >>> 0; // unsigned
    }
    // map to 1 â€” 22 km
    const km = 1 + (h % 210) / 10; // 1.0 to ~22.0
    return Math.round(km * 10) / 10; // one decimal
  }

  /* Pricing rules */
  const rates = {
    car: { per_km: 1.50, base: 3.00, min_fare: 4.50 },
    motor: { per_km: 0.80, base: 2.00, min_fare: 3.00 }
  };

  function computeEstimate(){
    const pickup = pickupInput.value.trim();
    const dest = destInput.value.trim();
    const estDistanceEl = document.getElementById('estDistance');
    const estPriceEl = document.getElementById('estPrice');
    const priceBreakEl = document.getElementById('priceBreak');
    const rideStatus = document.getElementById('rideStatus');

    if(!pickup || !dest){
      estDistanceEl.innerText = 'â€” km';
      estPriceEl.innerText = 'â€” RM';
      priceBreakEl.innerText = 'Fill pickup & destination';
      rideStatus.innerText = 'Enter pickup & destination for estimate.';
      return;
    }

    const km = deterministicDistance(pickup, dest);
    const rate = rates[selectedVehicle];
    const subtotal = Number((km * rate.per_km).toFixed(2));
    const fare = Math.max(subtotal + rate.base, rate.min_fare);
    estDistanceEl.innerText = km.toFixed(1) + ' km';
    estPriceEl.innerText = fare.toFixed(2) + ' RM';
    priceBreakEl.innerText = `Base ${rate.base.toFixed(2)} + ${rate.per_km.toFixed(2)}/km Ã— ${km.toFixed(1)} = ${subtotal.toFixed(2)} â†’ ${fare.toFixed(2)} RM`;
    rideStatus.innerText = 'Estimate ready â€” press Request Ride to book.';
  }

  /* Booking flow */
  function bookRide(){
    const pickup = pickupInput.value.trim();
    const dest = destInput.value.trim();
    const rideStatus = document.getElementById('rideStatus');
    const tripList = document.getElementById('tripList');

    if(!pickup || !dest){
      rideStatus.style.color = '#ff6b6b';
      rideStatus.innerText = 'Please fill pickup and destination.';
      return;
    }

    // booking info
    const dist = deterministicDistance(pickup, dest);
    const rate = rates[selectedVehicle];
    const subtotal = Number((dist * rate.per_km).toFixed(2));
    const fare = Math.max(subtotal + rate.base, rate.min_fare).toFixed(2);

    // update status
    rideStatus.style.color = ''; // reset to CSS color
    rideStatus.innerHTML = 'Finding a driver <span style="color:var(--accent-1)">â€¢</span>';
    // small neon loading effect
    let dots = 1;
    const ld = setInterval(()=> {
      dots = (dots % 3) + 1;
      rideStatus.innerHTML = 'Finding a driver ' + 'â€¢'.repeat(dots);
    }, 600);

    // simulate driver found after random small delay
    const delay = 1200 + (Math.random()*1600)|0;
    setTimeout(()=>{
      clearInterval(ld);
      rideStatus.innerHTML = `<span style="color:var(--accent-2); font-weight:700">Driver found!</span> â€” ETA ~ ${Math.max(2, Math.round(dist/2))} min. Fare: ${fare} RM`;
      // add to trips
      const item = document.createElement('div');
      item.className = 'trip';
      item.innerHTML = `<div><strong>${pickup}</strong> â†’ <strong>${dest}</strong><div class="small muted">${selectedVehicle.toUpperCase()} â€¢ ${dist.toFixed(1)} km</div></div><div style="text-align:right"><div style="font-weight:800">${fare} RM</div><div class="small muted">Now</div></div>`;
      // remove default
      if(tripList.querySelector('.muted') && tripList.children.length === 1) tripList.innerHTML = '';
      tripList.prepend(item);
    }, delay);
  }

  /* simulate driver button */
  function simulateDriver(){
    const rideStatus = document.getElementById('rideStatus');
    rideStatus.style.color = '';
    rideStatus.innerText = 'Simulating driver ping...';
    setTimeout(()=> {
      rideStatus.innerHTML = `<span style="color:var(--accent-1)">Driver nearby</span> â€” 3 min away`;
    },900);
  }

  // wire events
  document.getElementById('requestBtn').addEventListener('click', bookRide);
  document.getElementById('myTripsBtn').addEventListener('click', ()=> alert('Open recent trips (demo).'));

  // keyboard accessibility for vehicle selection
  document.querySelectorAll('.vehicle').forEach(v=>{
    v.addEventListener('keydown', e=>{
      if(e.key === 'Enter' || e.key === ' ') { chooseVehicle(v); e.preventDefault(); }
    });
  });

  // initial compute (if default inputs present)
  computeEstimate();
</script>
</body>
</html>
